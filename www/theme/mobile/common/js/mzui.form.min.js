/*!
 * mzui - v1.0.0 - 2015-08-30
 * Copyright (c) 2015 cnezsoft.com; Licensed MIT
 */
!function(a){a.fn.serializeArray=function(){var b,c,d=[],e=function(a){return a.forEach?a.forEach(e):void d.push({name:b,value:a})};return this[0]&&a.each(this[0].elements,function(d,f){c=f.type,b=f.name,b&&"fieldset"!=f.nodeName.toLowerCase()&&!f.disabled&&"submit"!=c&&"reset"!=c&&"button"!=c&&"file"!=c&&("radio"!=c&&"checkbox"!=c||f.checked)&&e(a(f).val())}),d},a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(b){a.push(encodeURIComponent(b.name)+"="+encodeURIComponent(b.value))}),a.join("&")},a.fn.submit=function(b){if(0 in arguments)this.bind("submit",b);else if(this.length){var c=a.Event("submit");this.eq(0).trigger(c),c.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(a,b){"use strict";var c,d=".ajaxform",e="Fingerprint",f=function(b){var c=a.getFingerprint(),d=b.find("#fingerprint");d.length||b.append("<input type='hidden' id='fingerprint'  name='fingerprint' value='"+c+"'>"),d.val(c)},g=function(a,b){var c=a.find('[type="submit"]'),d="INPUT"===c.get(0).tagName?"val":"text",e="disable"===b,f=c.data("loading"),g=e?c[d]():c.data("normal");e&&c.data("normal",g),c.attr("disabled",e?"disabled":null),c[d](e?f:g)},h=function(c,e){if(c.length&&!c.data(d)){c.data(d,1);var h=function(b,f){return e&&a.isFunction(e[b])?e[b](f):void c.trigger(b+d,f)},i=function(b){var d=c.find(".form-message");if(d.length){var e=d.find(".content");(e.length?e:d).html(b),d.show()}else a.messager.warning(b,{time:1e4})};h("init"),e.checkfingerprint&&f(c),c.submit(function(d){var e=c.serializeArray(),f={};a.each(e,function(a,b){f[b.name]=b.value}),h("onSubmit",f),g(c,"disable"),a.post(c.attr("action")||b.location.href,a.param(f),function(d,e){if("success"==e){try{if(typeof d==='string')d=a.parseJSON(d);"success"===d.result?(h("onResultSuccess",d),d.message?(a.messager.success(d.message),d.locate&&setTimeout(function(){location.href=d.locate},1200)):d.locate&&(location.href=d.locate)):d.message&&(a.isPlainObject(d.message)?a.each(d.message,function(b,d){a.isArray(d)&&d.length&&(d=d.length>1?"<ul><li>"+d.join("</li><li>")+"</li></ul>":d[0]);var e=c.find("#"+b+', [name="'+b+'"]').closest(".form-group");if(e.length){var f=e.find(".control-message");f.length?f.html(d):e.append('<div class="control-message">'+d+"</div>"),e.addClass("has-error")}else i(d)}):i(d.message))}catch(f){i(d||"No response.")}h("onSuccess",d)}else i("error: "+e),h("onError",e),b.v&&b.v.lang.timeout&&a.messager.danger(b.v.lang.timeout);g(c),h("onComplete",{response:d,status:e})}),d.preventDefault()}).on("change",function(b){c.find(".form-message").hide(),a(b.target).closest(".form-group").removeClass("has-error")})}};a.fn.ajaxform=function(b){return a(this).each(function(){var c=a(this);h(c,a.extend(c.data(),b))})},a.getFingerprint=function(){return c||(a.isFunction(b[e])?c=(new b[e]).get():(c="",a.each(navigator,function(a,b){"string"==typeof b&&(c+=b.length)}))),c},a(function(){a(".ajaxform").ajaxform()})}(Zepto,window);
